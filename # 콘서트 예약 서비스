# 콘서트 예약 서비스

## Description

- **`콘서트 예약 서비스 시나리오`** 입니다.
- 대기열 시스템을 구축하고, 예약 서비스는 작업가능한 유저만 수행할 수 있도록 해야합니다.
- 사용자는 좌석예약 시에 미리 충전한 잔액을 이용합니다.
- 좌석 예약 요청시에, 결제가 이루어지지 않더라도 일정 시간동안 다른 유저가 해당 좌석에 접근할 수 없도록 합니다.

## Requirements

- 아래 5가지 API 를 구현합니다.
    - 예약 가능 날짜 / 좌석 API (콘서트 조회)
    - 좌석 예약 요청 API
    - 포인트 충전 / 조회 API
    - 결제 API
    - 유저 대기열 토큰 발급 API
- 각 기능 및 제약사항에 대해 단위 테스트를 반드시 하나 이상 작성하도록 합니다.
- 다수의 인스턴스로 어플리케이션이 동작하더라도 기능에 문제가 없도록 작성하도록 합니다.
- 동시성 이슈를 고려하여 구현합니다.
- 대기열 개념을 고려해 구현합니다.

## API Specs

1️⃣ **`필수` 예약 가능 날짜 / 좌석 API (콘서트 조회)**

- 예약가능한 날짜와 해당 날짜의 좌석을 조회하는 API 를 각각 작성합니다.
- 예약 가능한 날짜 목록을 조회할 수 있습니다.
- 날짜 정보를 입력받아 예약가능한 좌석정보를 조회할 수 있습니다.

> 좌석 정보는 1 ~ 50 까지의 좌석번호로 관리됩니다.
> 

**2️⃣** **`필수` 좌석 예약 요청 API**

- 날짜와 좌석 정보를 입력받아 좌석을 예약 처리하는 API 를 작성합니다.
- 좌석 예약과 동시에 해당 좌석은 그 유저에게 약 5분간 임시 배정됩니다. ( 시간은 정책에 따라 자율적으로 정의합니다. )
- 만약 배정 시간 내에 결제가 완료되지 않는다면 좌석에 대한 임시 배정은 해제되어야 하며 다른 사용자는 예약할 수 있어야 한다.

3️⃣ **`필수`**  **포인트 충전 / 조회 API**

- 결제에 사용될 포인트를 API 를 통해 충전하는 API 를 작성합니다.
- 사용자 식별자 및 충전할 금액을 받아 포인트를 충전합니다.
- 사용자 식별자를 통해 해당 사용자의 포인트를 조회합니다.

4️⃣ **`필수` 결제 API**

- 결제 처리하고 결제 내역을 생성하는 API 를 작성합니다.
- 결제가 완료되면 해당 좌석의 소유권을 유저에게 배정하고 대기열 토큰을 만료시킵니다.


### 1. `로직 구현 및 테스트코드 작성`

- 각 시나리오별 하기 **비즈니스 로직** 개발 및 **단위 테스트** 작성
    - `concert` : 콘서트 조회, 예약/결제 기능, 포인트 충전 기능
    - 단, 비지니스 로직에서 다음을 따라야 합니다.
        - 한개의 비지니스 로직을 클린아키텍처로 구현하고 다른 비지니스 로직은 레이어드로 구현할것 
            - 회사에서 많이 사용하는 **레이어드 아키텍처** 위에 **클린의 장점(의존성 규칙)**을 더한다고 생각하면 됩니다.
            - 클린 아키텍처는 완전히 새로운 구조를 만드는 게 아니라, 기존 Controller-Service-Repository 틀은 유지하되 **도메인 중심 규칙**을 적용하는 것
            - “콘서트 시나리오에서는 '예약/결제 기능'을 클린 아키텍처로 구현”
                - 좌석 예약, 결제 프로세스, 알림 발송 등 여러 기능이 유기적으로 결합되어 있어서 클린 아키텍처를 적용하면 각 책임을 명확히 분리하고 테스트하기 쉬움
            - 여러 기능 Mock을 적극 활용해주세요
                - 예를들어
                    - `좌석 예약/결제` 기능에서는 `SeatRepository`, `ReservationRepository`, `PaymentService` 등을 전부 Mock 처리하고,
                    좌석 점유/해제, 결제 완료 처리 등의 예약 로직만 검증하도록 작성합니다.

> **단위 테스트** 는 반드시 대상 객체/기능 에 대한 의존성만 존재해야 함


### 2. **`심화 로직 구현 및 테스트코드 작성`**

- 각 시나리오별 하기 **비즈니스 로직** 개발 및 **단위 테스트** 작성
    - `concert` : 대기열 관련 기능

> **단위 테스트** 는 반드시 대상 객체/기능 에 대한 의존성만 존재해야 함
