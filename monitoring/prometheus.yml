# Prometheus Configuration for Load Testing

global:
  scrape_interval: 15s      # 15초마다 메트릭 수집
  evaluation_interval: 15s  # Alert Rule 평가 주기
  scrape_timeout: 10s

  external_labels:
    monitor: 'concert-loadtest'

# Scrape Configurations
scrape_configs:
  # Prometheus 자체 메트릭
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # NestJS Application 메트릭
  - job_name: 'concert-app-small'
    static_configs:
      - targets: ['app-small:3000']
        labels:
          instance: 'small'
          spec: '0.5cpu-512m'

  - job_name: 'concert-app-medium'
    static_configs:
      - targets: ['app-medium:3000']
        labels:
          instance: 'medium'
          spec: '1cpu-1g'

  - job_name: 'concert-app-large'
    static_configs:
      - targets: ['app-large:3000']
        labels:
          instance: 'large'
          spec: '2cpu-2g'

  # cAdvisor - 컨테이너 리소스 메트릭
  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']

  # MySQL Exporter (필요시 추가)
  # - job_name: 'mysql'
  #   static_configs:
  #     - targets: ['mysql-exporter:9104']

  # Redis Exporter (필요시 추가)
  # - job_name: 'redis'
  #   static_configs:
  #     - targets: ['redis-exporter:9121']

# Alert Rules (선택 사항)
# rule_files:
#   - 'alert_rules.yml'
